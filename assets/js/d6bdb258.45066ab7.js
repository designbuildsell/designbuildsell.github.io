(self.webpackChunkdbs=self.webpackChunkdbs||[]).push([[2476],{2634:()=>{},5340:()=>{},6741:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>x});var s=t(6540),r=t(4677),l=t(4500);const n=l.Ik({id:l.Yj().regex(/^[a-z0-9-]+$/),url:l.Yj().url(),name:l.Yj(),category:l.Yj().optional(),enabled:l.zM().default(!0),maxItems:l.ai().min(1).max(10).default(5)}),i=l.Ik({feeds:l.YO(n)});var d=t(4229),o=t.n(d),c=t(1062),m=t(4848);const h="/data/rss-feeds.json",g="rss-hub-cache",f=()=>(0,m.jsxs)("div",{className:"card margin-bottom--lg",children:[(0,m.jsxs)("div",{className:"card__header",children:[(0,m.jsx)("div",{className:"skeleton",style:{height:20,width:"70%",marginBottom:"0.5rem"}}),(0,m.jsx)("div",{className:"skeleton",style:{height:14,width:"40%"}})]}),(0,m.jsxs)("div",{className:"card__body",children:[(0,m.jsx)("div",{className:"skeleton",style:{height:16,width:"90%",marginBottom:"0.5rem"}}),(0,m.jsx)("div",{className:"skeleton",style:{height:16,width:"80%"}})]})]}),u=({feedName:e,error:a})=>(0,m.jsxs)("div",{className:"card card--danger margin-bottom--lg",children:[(0,m.jsx)("div",{className:"card__header",children:(0,m.jsxs)("h3",{children:["Error loading: ",e]})}),(0,m.jsxs)("div",{className:"card__body",children:[(0,m.jsx)("p",{children:"This feed could not be loaded. It might be temporarily unavailable or the URL may be incorrect."}),!1]})]}),j=({feeds:e})=>{const[a,t]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[n,i]=(0,s.useState)({}),[d,c]=(0,s.useState)("all");(0,s.useEffect)(()=>{const a=new(o());(async()=>{l(!0);const s=e.map(async e=>{try{return(await a.parseURL(e.url)).items.slice(0,e.maxItems).map(a=>({feed:e,item:a}))}catch(t){return i(a=>({...a,[e.id]:t})),[]}}),r=(await Promise.all(s)).flat();r.sort((e,a)=>new Date(a.item.isoDate).getTime()-new Date(e.item.isoDate).getTime()),t(r),l(!1)})()},[e]);const h=(0,s.useMemo)(()=>["all",...new Set(e.map(e=>e.category).filter(Boolean))],[e]),g=(0,s.useMemo)(()=>"all"===d?a:a.filter(e=>e.feed.category===d),[a,d]);return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"margin-bottom--md",children:[(0,m.jsx)("label",{htmlFor:"category-filter",style:{marginRight:"1rem"},children:"Filter by category:"}),(0,m.jsx)("select",{id:"category-filter",value:d,onChange:e=>c(e.target.value),children:h.map(e=>(0,m.jsx)("option",{value:e,children:e},e))})]}),Object.entries(n).map(([a,t])=>{const s=e.find(e=>e.id===a);return s?(0,m.jsx)(u,{feedName:s.name,error:t},a):null}),r&&Array.from({length:5}).map((e,a)=>(0,m.jsx)(f,{},a)),!r&&g.map(({feed:e,item:a},t)=>(0,m.jsxs)("div",{className:"card margin-bottom--lg",children:[(0,m.jsxs)("div",{className:"card__header",children:[(0,m.jsx)("h3",{children:(0,m.jsx)("a",{href:a.link,target:"_blank",rel:"noopener noreferrer",children:a.title})}),(0,m.jsxs)("small",{children:["From ",e.name," \u2022 ",new Date(a.isoDate).toLocaleString(),e.category&&(0,m.jsx)("span",{className:"badge badge--secondary margin-left--sm",children:e.category})]})]}),(0,m.jsx)("div",{className:"card__body",children:(0,m.jsx)("p",{children:a.contentSnippet})})]},`${e.id}-${t}`))]})},x=()=>{const e=(0,c.A)(),[a,t]=(0,s.useState)(null),[l,n]=(0,s.useState)(null),[d,o]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(!e)return;(async()=>{try{0;const e=await fetch(h),a=await e.text();if(a.trim().startsWith("<!DOCTYPE")||!e.ok)throw new Error(`Received HTML response. This usually means the file was not found at ${h}`);const s=JSON.parse(a),r=i.parse(s);t(r),localStorage.setItem(g,JSON.stringify({data:r,timestamp:Date.now()}))}catch(e){console.error("Failed to load feed configuration:",e),n(e);try{const e=localStorage.getItem(g);if(e){const{data:a,timestamp:s}=JSON.parse(e);Date.now()-s<864e5&&(console.log("Using cached feed configuration"),t(a),n(null))}}catch(a){console.error("Failed to read from cache:",a)}}finally{o(!1)}})()},[e]);const f=(0,s.useMemo)(()=>a?.feeds.filter(e=>e.enabled)??[],[a]);return(0,m.jsx)(r.A,{title:"RSS Hub",description:"An aggregation of external RSS feeds.",children:(0,m.jsxs)("main",{className:"container margin-vert--lg",children:[(0,m.jsx)("h1",{children:"RSS Hub"}),(0,m.jsx)("p",{children:"A collection of interesting feeds from around the web."}),d&&(0,m.jsx)("p",{children:"Loading feed configuration..."}),l&&!a&&(0,m.jsxs)("div",{className:"alert alert--danger",children:[(0,m.jsx)("h4",{children:"Failed to Load Feeds"}),(0,m.jsx)("p",{children:"The feed configuration could not be loaded. Please try again later."}),!1]}),f.length>0&&(0,m.jsx)(j,{feeds:f})]})})}},9838:()=>{}}]);